---
title: "Elasticsearch"
---
Collects Elasticsearch performance and health metrics from Elasticsearch clusters and nodes.

Prerequisites
-------------
<ul>
    <li>Middleware Host agent should be already installed on your machine, in order to use Elasticsearch integration.</li>
</ul>

## Setup
1. You will have to create a yaml file in your system containing database collection details, as follows:

Ex. `/home/ubuntu/elasticsearch-creds.yaml`
```
elasticsearch:
  endpoint: http://localhost:9200
  username: elastic
  password: changeme
```
<Note>It is necessary to mention `username` and `password` in the YAML file.</Note>

<Note><strong>For Docker Agent Users</strong>: If you are running the Middleware Docker agent, then we recommend to keep the creds YAML under `/var/log` directory. This is because, the Docker agent might not support dynamic volume binding.</Note>


2. Go to Store, Enable Elasticsearch Integration, Select a host, and set YAML path to the file created in step 1.
<img src="/images/integration/elasticsearch-store.png" />

## Visualize Analytics
There are 2 possible ways to Visualize Elasticsearch Analytics:

### 1. Middleware's Default Elasticsearch Dashboard
Once you've setup the Elasticsearch Integration, You will be able to see different Analytics in the default Elasticsearch Dashboard.
<img src="/images/integration/elasticsearch-dashboard.png" />

### 2. Create your own dashboard
<p>You can create your own dashboard from scratch.</p>
<p>When you add a new widget to an existing dashboard, you'll see a list of available Elasticsearch metrics under the "elasticsearch" Data source.</p>
<p>These metrics can be visualized in different widget types like Timeseries, Bar Chart, Pie Chart, etc.</p>

<img src="/images/integration/elasticsearch-custom-graphs.png" />

## Metrics collected

| Metric                                                          | Description                                                                                                       |
|-----------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| elasticsearch.breaker.memory.estimated                          | Estimated memory used for the operation.                                                                          |
| elasticsearch.breaker.memory.limit                              | Memory limit for the circuit breaker.                                                                             |
| elasticsearch.breaker.tripped                                   | Total number of times the circuit breaker has been triggered and prevented an out of memory error.                |
| elasticsearch.node.cache.memory.usage                           | The size in bytes of the cache on a node.                                                                         |
| elasticsearch.node.cache.evictions                              | The number of evictions from the cache on a node.                                                                 |
| elasticsearch.node.cache.count                                  | Total count of query cache misses across all shards assigned to selected nodes.                                   |
| elasticsearch.node.fs.disk.available                            | The amount of disk space available to the JVM across all file stores for this node.                               |
| elasticsearch.node.fs.disk.free                                 | The amount of unallocated disk space across all file stores for this node.                                        |
| elasticsearch.node.fs.disk.total                                | The amount of disk space across all file stores for this node.                                                    |
| elasticsearch.node.disk.io.read                                 | The total number of kilobytes read across all file stores for this node.                                          |
| elasticsearch.node.disk.io.write                                | The total number of kilobytes written across all file stores for this node.                                       |
| elasticsearch.node.cluster.io                                   | The number of bytes sent and received on the network for internal cluster communication.                          |
| elasticsearch.node.cluster.connections                          | The number of open tcp connections for internal cluster communication.                                            |
| elasticsearch.node.http.connections                             | The number of HTTP connections to the node.                                                                       |
| elasticsearch.node.operations.completed                         | The number of operations completed by a node.                                                                     |
| elasticsearch.node.operations.time                              | Time spent on operations by a node.                                                                               |
| elasticsearch.node.shards.size                                  | The size of the shards assigned to this node.                                                                     |
| elasticsearch.node.shards.data_set.size                         | Total data set size of all shards assigned to the node.                                                           |
| elasticsearch.node.shards.reserved.size                         | A prediction of how much larger the shard stores on this node will eventually grow.                               |
| elasticsearch.node.translog.operations                          | Number of transaction log operations.                                                                             |
| elasticsearch.node.translog.size                                | Size of the transaction log.                                                                                      |
| elasticsearch.node.translog.uncommitted.size                    | Size of uncommitted transaction log operations.                                                                   |
| elasticsearch.node.thread_pool.threads                          | The number of threads in the thread pool.                                                                         |
| elasticsearch.node.thread_pool.tasks.queued                     | The number of queued tasks in the thread pool.                                                                    |
| elasticsearch.node.thread_pool.tasks.finished                   | The number of tasks finished by the thread pool.                                                                  |
| elasticsearch.node.documents                                    | The number of documents on the node.                                                                              |
| elasticsearch.node.open_files                                   | The number of open file descriptors held by the node.                                                             |
| jvm.classes.loaded                                              | The number of loaded classes.                                                                                     |
| jvm.gc.collections.count                                        | The total number of garbage collections that have occurred.                                                       |
| jvm.gc.collections.elapsed                                      | The approximate accumulated collection elapsed time.                                                              |
| jvm.memory.heap.max                                             | The maximum amount of memory can be used for the heap.                                                            |
| jvm.memory.heap.used                                            | The current heap memory usage.                                                                                    |
| jvm.memory.heap.committed                                       | The amount of memory that is guaranteed to be available for the heap.                                             |
| jvm.memory.nonheap.used                                         | The current non-heap memory usage.                                                                                |
| jvm.memory.nonheap.committed                                    | The amount of memory that is guaranteed to be available for non-heap purposes.                                    |
| jvm.memory.pool.max                                             | The maximum amount of memory can be used for the memory pool.                                                     |
| jvm.memory.pool.used                                            | The current memory pool memory usage                                                                              |
| jvm.threads.count                                               | The current number of threads                                                                                     |
| elasticsearch.cluster.pending_tasks                             | The number of cluster-level changes that have not yet been executed.                                              |
| elasticsearch.cluster.in_flight_fetch                           | The number of unfinished fetches.                                                                                 |
| elasticsearch.cluster.shards                                    | The number of shards in the cluster.                                                                              |
| elasticsearch.cluster.data_nodes                                | The number of data nodes in the cluster.                                                                          |
| elasticsearch.cluster.nodes                                     | The total number of nodes in the cluster.                                                                         |
| elasticsearch.cluster.health                                    | The health status of the cluster.                                                                                 |
| elasticsearch.os.cpu.usage                                      | Recent CPU usage for the whole system, or -1 if not supported.                                                    |
| elasticsearch.os.cpu.load_avg.1m                                | One-minute load average on the system (field is not present if one-minute load average is not available).         |
| elasticsearch.os.cpu.load_avg.5m                                | Five-minute load average on the system (field is not present if five-minute load average is not available).       |
| elasticsearch.os.cpu.load_avg.15m                               | Fifteen-minute load average on the system (field is not present if fifteen-minute load average is not available). |
| elasticsearch.os.memory                                         | Amount of physical memory.                                                                                        |
| elasticsearch.memory.indexing_pressure                          | Memory consumed, in bytes, by indexing requests in the specified stage.                                           |
| elasticsearch.indexing_pressure.memory.total.primary_rejections | Cumulative number of indexing requests rejected in the primary stage.                                             |
| elasticsearch.indexing_pressure.memory.total.replica_rejections | Number of indexing requests rejected in the replica stage.                                                        |
| elasticsearch.indexing_pressure.memory.limit                    | Configured memory limit, in bytes, for the indexing requests.                                                     |
| elasticsearch.cluster.state_queue                               | Number of cluster states in the queue.                                                                            |
| elasticsearch.cluster.published_states.full                     | Number of published cluster states.                                                                               |
| elasticsearch.cluster.published_states.differences              | Number of differences between published cluster states.                                                           |
| elasticsearch.cluster.state_update.count                        | The number of cluster state update attempts that changed the cluster state since the node started.                |
| elasticsearch.cluster.state_update.time                         | The cumulative amount of time updating the cluster state since the node started.                                  |
| elasticsearch.cluster.indices.cache.evictions                   | The number of evictions from the cache for indices in the cluster.                                                |
| elasticsearch.node.ingest.documents                             | Total number of documents ingested during the lifetime of this node.                                              |
| elasticsearch.node.ingest.documents.current                     | Total number of documents currently being ingested.                                                               |
| elasticsearch.node.ingest.operations.failed                     | Total number of failed ingest operations during the lifetime of this node.                                        |
| elasticsearch.node.pipeline.ingest.documents.preprocessed       | Number of documents preprocessed by the ingest pipeline.                                                          |
| elasticsearch.node.pipeline.ingest.operations.failed            | Total number of failed operations for the ingest pipeline.                                                        |
| elasticsearch.node.pipeline.ingest.documents.current            | Total number of documents currently being ingested by a pipeline.                                                 |
| elasticsearch.node.script.compilations                          | Total number of inline script compilations performed by the node.                                                 |
| elasticsearch.node.script.cache_evictions                       | Total number of times the script cache has evicted old data.                                                      |
| elasticsearch.node.script.compilation_limit_triggered           | Total number of times the script compilation circuit breaker has limited inline script compilations.              |
| elasticsearch.node.segments.memory                              | Size of memory for segment object of a node.                                                                      |
| elasticsearch.index.operations.completed                        | The number of operations completed for an index.                                                                  |
| elasticsearch.index.operations.time                             | Time spent on operations for an index.                                                                            |
| elasticsearch.index.shards.size                                 | The size of the shards assigned to this index.                                                                    |
| elasticsearch.process.cpu.usage                                 | CPU usage in percent.                                                                                             |
| elasticsearch.node.operations.current                           | Number of query operations currently running.                                                                     |
| elasticsearch.index.documents                                   | The number of documents for an index.                                                                             |
| elasticsearch.process.memory.virtual                            | Size of virtual memory that is guaranteed to be available to the running process.                                 |
| elasticsearch.process.cpu.time                                  | CPU time used by the process on which the Java virtual machine is running.                                        |


<Note> Need assistance or want to learn more about Middleware? Contact us at support[at]middleware.io. </Note>