---
title: "Cloudflare APM Setup"
---
<table border="1" style={{margin: "10px 0", textAlign: "center"}}>
    <thead>
    <tr>
        <th style={{padding:"8px 15px"}}>Traces</th>
        <th style={{padding:"8px 15px"}}>Metrics</th>
        <th style={{padding:"8px 15px"}}>App Logs</th>
        <th style={{padding:"8px 15px"}}>Custom Logs</th>
        <th style={{padding:"8px 15px"}}>Profiling</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td><span style={{
            background: "url(/images/misc/svg-check.svg) no-repeat",
            width: "20px",
            height: "20px",
            display: "inline-block",
        }}/></td>
        <td>-</td>
        <td>-</td>
        <td><span style={{
            background: "url(/images/misc/svg-check.svg) no-repeat",
            width: "20px",
            height: "20px",
            display: "inline-block",
        }}/></td>
        <td>-</td>
    </tr>
    </tbody>
</table>

<Note> You can refer [this wrangler project](https://github.com/middleware-labs/demo-apm/tree/master/cloudflare) to see Cloudflare APM in action. </Note>

In order to track http requests in your cloudflare worker, follow these steps

### Step 1 :  Install Middleware Worker Package

```
npm i @middleware.io/agent-apm-worker
```

### Step 2 : Import Tracker
```javascript
import * as tracker from "@middleware.io/agent-apm-worker";
```

### Step 3 : Initialize Tracker with your Middleare API key  

Add this snippet given below and replace the required details.
```javascript
tracker.init({
    projectName:"{APM-PROJECT-NAME}",
    serviceName:"{APM-SERVICE-NAME}",
    accountKey:"{ACCOUNT_KEY}",
    target:"https://{ACCOUNT-UID}.middleware.io"
})
```
<Note> If you want to watch instrumented logs in terminal, set consoleLogEnabled:true </Note>

### Step 4 : Track all the requests with middleware SDK
```javascript		
const sdk = tracker.track(request, ctx);
sdk.sendResponse(response);
```

### Step 5 : Add Logging
```javascript
// sdk.logger.SEVERITY( MESSAGE, KEY-VALUE PAIRS )

sdk.logger.error("error test")
sdk.logger.error("error with attributes",{"log.file.name":"error.log"})
sdk.logger.info("info test")
sdk.logger.debug("debug test")
sdk.logger.warn("warn test")
```

