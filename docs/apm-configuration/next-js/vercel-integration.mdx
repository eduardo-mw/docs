## Overview
Integrating Vercel with Middleware allows you to monitor, analyze, and store traces generated by your Serverless Functions. Additionally, Middleware provides a centralized dashboard where you can view all logs, metrics, and traces in a single place. Real User Monitoring allows you to monitor performance and understand user behavior, while Synthetics Monitoring enables you to simulate global traffic and measure endpoint uptime.


## Additional Information
Once you set up the integration, traces from your Vercel project will be streamed to Middleware, and you can view all the traces in Middleware's Application Performance Monitoring (APM). Our Vercel dashboard provides summary metrics and access points to drill down into your traces. You can monitor and analyze your Vercel traces along with traces from your infrastructure and applications in Middleware's APM. In Middleware's APM, you can view all the details, including service name, latency, number of requests, success ratio, duration, method name, trace profiling, and attributes. You can also create custom dashboards in Middleware to view the log and trace data that is most important to you and create alerts on different parameters.



## Prerequisites
Before using this integration, you need to create a project that will be deployed on the Vercel platform. You can refer to this <a href="https://vercel.com/docs/concepts/projects/overview" rel="nofollow noopener noreferrer" target="_blank" translate="no"> link </a> to learn more about Vercel deployment.



## Getting Started
Follow these steps to integrate Middleware into your Vercel project and track your project activity on a live basis:

1. Install the following package that will help to send all the traces generated from your project. This package will instrument your project based on the OpenTelemetry approach.

```javascript Shell
npm install @middleware.io/agent-apm-nextjs
```

2. As this feature is experimental, modify your next.config.js where you need to explicitly opt-in by enabling the instrumentation hook as true. Check the following code for a better idea:

```javascript Shell
const nextConfig = {
     ---
     ---
     experimental: {
         instrumentationHook: true
     }
     ---
     ---
}
module.exports = nextConfig
```

3. Create a custom instrumentation.ts file in your project root directory, and add the following code:

```javascript Shell
// @ts-ignore
import { track } from '@middleware.io/agent-apm-nextjs';

export function register() {
    track({
        projectName: "<PROJECT-NAME>",
        serviceName: "<SERVICE-NAME>",
        target: "vercel",
    });
}
```
    <Note>For additional information and in-depth guidance, you can clone the sample project from the [GitHub](https://github.com/middleware-labs/demo-apm/tree/master/nextjs/setup) repository to explore further.</Note>

4. Now deploy your project to vercel platform.
5. Integrate <a href="https://vercel.com/integrations/middleware" rel="nofollow noopener noreferrer" target="_blank" translate="no"> Middleware </a> from the Vercel marketplace


## Steps to integrate
To integrate the Middleware, follow these steps.
<ol>
   
    <li>Go to Vercel’s marketplace, and search for “Middleware”, or go directly to this <a href="https://vercel.com/integrations/middleware/new" rel="nofollow noopener noreferrer" target="_blank" translate="no"> link </a> <img src="/images/agent-installation/vercel-1.png" /> </li>
    <li>Click “Add Integration”. </li>
    <li>From the popup window, select the Vercel account, that you want to connect, and then click “Continue”.  <img src="/images/agent-installation/vercel-2.png" /></li>
     <li>Select the project, which you want to track, so here you can select all of your projects or choose any specific also, then click “Continue”.  <img src="/images/agent-installation/vercel-3.png" />  </li>
     <li>On the next step, the popup will show which of the permission should be granted to track your project. To proceed, click  “Add integration”. <img src="/images/agent-installation/vercel-4.png" /> </li>
      <li>You will be redirected to the Middleware’s Login page, where you can log in with your account so that Vercel will be able to send all the activity to your Middleware’s dashboard.  <img src="/images/agent-installation/vercel-5.png"/></li>
      <li>After logging in, Middleware and Vercel will exchange tokens to establish seamless collaboration, enabling comprehensive activity tracking. Upon completing this final step, you will receive a confirmation message indicating a successful installation. <img src="/images/agent-installation/vercel-6.png" /></li>
      <li>After 3sec, You will be redirected back to the marketplace page with Middleware integrated. </li>
</ol>

## Visualize Your Data
Once you have set up the integration between Vercel and Middleware, you can visualize your data in Middleware's dashboard. The dashboard provides an overview of your Vercel project's performance and allows you to drill down into your traces.
<img src="/images/agent-installation/vercel-7.png" />

You can view your traces in the dedicated Traces screen, which shows you detailed information about each trace, including service name, latency, number of requests, success ratio, duration, method name, trace profiling, and attributes. In addition to the Traces screen, you can also view your Vercel traces along with traces from your infrastructure and applications in Middleware's Application Performance Monitoring (APM).
<img src="/images/agent-installation/vercel-8.png" />


## Troubleshoot
If you have integrated Middleware and are still not getting your traces, try redeploying your project. This should ensure that the traces are properly generated and collected by Middleware. 

If you still encounter issues, please refer to the Middleware documentation or reach out to out support team for assistance.


## Conclusion
Integrating Vercel with Middleware allows you to monitor and analyze traces generated by your serverless functions in a unified dashboard, along with other things. By following the steps outlined in this guide, you can easily set up the integration and start tracking your project’s raw activity on a live basis. 

With Middleware's real user monitoring and synthetics monitoring capabilities, you can gain valuable insights into user behavior and endpoint uptime. If you encounter any issues or have any questions, don't hesitate to reach out to Middleware's support team for assistance.
